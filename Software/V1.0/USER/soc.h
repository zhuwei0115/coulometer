#ifndef __SOC_H
#define __SOC_H

#include "stm32f10x.h"
#include "sys.h" 
#if 0
 const OCV_VALUE_S  OcvTable_Dischg_1C[101] = {         {2999, 0},
        {3129, 1},  {3262, 2},  {3292, 3},  {3314, 4},  {3330, 5},
        {3344, 6},  {3366, 7},  {3375, 8},  {3383, 9},  {3390, 10},
        {3404, 11}, {3410, 12}, {3416, 13}, {3421, 14}, {3426, 15},
        {3437, 16}, {3441, 17}, {3446, 18}, {3450, 19}, {3454, 20},
        {3462, 21}, {3466, 22}, {3470, 23}, {3473, 24}, {3480, 25},
        {3484, 26}, {3487, 27}, {3490, 28}, {3493, 29}, {3497, 30},
        {3503, 31}, {3506, 32}, {3510, 33}, {3513, 34}, {3519, 35},
        {3523, 36}, {3526, 37}, {3529, 38}, {3532, 39}, {3539, 40},
        {3543, 41}, {3546, 42}, {3550, 43}, {3554, 44}, {3561, 45},
        {3565, 46}, {3569, 47}, {3573, 48}, {3578, 49}, {3587, 50},
        {3592, 51}, {3596, 52}, {3601, 53}, {3607, 54}, {3617, 55},
        {3623, 56}, {3629, 57}, {3635, 58}, {3641, 59}, {3654, 60},
        {3661, 61}, {3667, 62}, {3674, 63}, {3688, 64}, {3696, 65},
        {3703, 66}, {3710, 67}, {3718, 68}, {3726, 69}, {3741, 70},
        {3749, 71}, {3758, 72}, {3766, 73}, {3782, 74}, {3790, 75},
        {3799, 76}, {3807, 77}, {3816, 78}, {3833, 79}, {3842, 80},
        {3851, 81}, {3860, 82}, {3877, 83}, {3887, 84}, {3896, 85},
        {3905, 86}, {3914, 87}, {3933, 88}, {3943, 89}, {3953, 90},
        {3962, 91}, {3972, 92}, {3992, 93}, {4002, 94}, {4013, 95},
        {4024, 96}, {4048, 97}, {4063, 98}, {4082, 99}, {4190, 100}};
// 单个三元锂电压对应容量
#endif

typedef struct{
	u16 Voltage;
	u8  SOC;
}OCV_Value_TypeDef;

typedef struct{
	u8  SOC;
	u16 Current_Capacity;
}Bat_Status;


const OCV_Value_TypeDef  OcvTable_Dischg_1C[101] = {		   {4798, 0},
			   {5006, 1},  {5219, 2},  {5267, 3},  {5302, 4},  {5328, 5},
			   {5350, 6},  {5386, 7},  {5400, 8},  {5413, 9},  {5424, 10},
			   {5446, 11}, {5456, 12}, {5466, 13}, {5474, 14}, {5482, 15},
			   {5499, 16}, {5506, 17}, {5514, 18}, {5520, 19}, {5526, 20},
			   {5539, 21}, {5546, 22}, {5552, 23}, {5557, 24}, {5568, 25},
			   {5574, 26}, {5579, 27}, {5584, 28}, {5589, 29}, {5595, 30},
			   {5605, 31}, {5610, 32}, {5616, 33}, {5621, 34}, {5630, 35},
			   {5637, 36}, {5642, 37}, {5646, 38}, {5651, 39}, {5662, 40},
			   {5669, 41}, {5674, 42}, {5680, 43}, {5686, 44}, {5698, 45},
			   {5704, 46}, {5710, 47}, {5717, 48}, {5725, 49}, {5739, 50},
			   {5747, 51}, {5754, 52}, {5762, 53}, {5771, 54}, {5787, 55},
			   {5797, 56}, {5806, 57}, {5816, 58}, {5826, 59}, {5846, 60},
			   {5858, 61}, {5867, 62}, {5878, 63}, {5901, 64}, {5914, 65},
			   {5925, 66}, {5936, 67}, {5949, 68}, {5962, 69}, {5986, 70},
			   {5998, 71}, {6013, 72}, {6026, 73}, {6051, 74}, {6064, 75},
			   {6078, 76}, {6091, 77}, {6106, 78}, {6133, 79}, {6147, 80},
			   {6162, 81}, {6176, 82}, {6203, 83}, {6219, 84}, {6234, 85},
			   {6248, 86}, {6262, 87}, {6293, 88}, {6309, 89}, {6325, 90},
			   {6339, 91}, {6355, 92}, {6387, 93}, {6403, 94}, {6421, 95},
			   {6438, 96}, {6477, 97}, {6501, 98}, {6531, 99}, {6704, 100}};
//电压值*16后,除以10 四舍五入
//adc电压放大了100倍，此处放大了1000倍，所以需要除以10


Bat_Status Get_OCV_SOC(ADC_Value * ADC_Value_Struct ,u16 Bat_Capacity);
Bat_Status Get_Realtime_SOC(ADC_Value * ADC_Value_Struct , Bat_Status *Old_Status , u8 Interval , u16 Bat_Capacity);


#endif
